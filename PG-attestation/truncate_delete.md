ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ â€” `TRUNCATE` Ð¸ `DELETE` Ð² PostgreSQL **Ð¾Ð±Ð° ÑƒÐ´Ð°Ð»ÑÑŽÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹**, Ð½Ð¾ **Ð´ÐµÐ»Ð°ÑŽÑ‚ ÑÑ‚Ð¾ Ð¿Ð¾-Ñ€Ð°Ð·Ð½Ð¾Ð¼Ñƒ**.

---

## ðŸ§¨ Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð¸Ðµ:

|                       | `DELETE`                         | `TRUNCATE`                      |
| --------------------- | -------------------------------- | ------------------------------- |
| **Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ**          | ÐœÐµÐ´Ð»ÐµÐ½Ð½Ð¾ (ÑÑ‚Ñ€Ð¾ÐºÐ° Ð·Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð¹)     | ÐžÑ‡ÐµÐ½ÑŒ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ (Ð¾Ð±Ñ€ÐµÐ·Ð°ÐµÑ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ) |
| **Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚**           | ÐœÐ¾Ð¶Ð½Ð¾ `ROLLBACK` (Ð´Ð°)            | ÐœÐ¾Ð¶Ð½Ð¾ `ROLLBACK` (Ð´Ð°)           |
| **Ð¢Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹**          | **Ð¡Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚** (`AFTER DELETE`) | **ÐÐµ ÑÑ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚**              |
| **WHERE**             | Ð”Ð° â€” Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ñ‡Ð½Ð¾             | âŒ â€” ÑƒÐ´Ð°Ð»ÑÐµÑ‚ **Ð²ÑÑ‘**             |
| **Ð¡Ð±Ñ€Ð¾Ñ ID**          | ÐÐµÑ‚                              | Ð”Ð° (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ `SERIAL`)         |
| **Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸**        | Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÑ‚ ÑÑ‚Ñ€Ð¾ÐºÐ¸                 | Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÑ‚ **Ð²ÑÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ**       |
| **Ð’Ð»Ð¸ÑÐ½Ð¸Ðµ Ð½Ð° VACUUM** | Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ `VACUUM` Ð¿Ð¾ÑÐ»Ðµ           | ÐÐµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚                      |

---

## ðŸ” ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹:

### `DELETE`: ÑƒÐ´Ð°Ð»ÑÐµÑ‚ **Ð¿Ð¾ ÑƒÑÐ»Ð¾Ð²Ð¸ÑŽ** Ð¸ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹

```sql
DELETE FROM sales WHERE employee = 'Alice';
```

* ÐœÐ¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÐ°Ñ‚Ð¸Ñ‚ÑŒ.
* Ð¢Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹ `AFTER DELETE` ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚.
* ÐœÐ¾Ð¶Ð½Ð¾ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ‡Ð°ÑÑ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ñ….

---

### `TRUNCATE`: ÑƒÐ´Ð°Ð»ÑÐµÑ‚ **Ð²ÑÑ‘** Ð±Ñ‹ÑÑ‚Ñ€Ð¾

```sql
TRUNCATE TABLE sales;
```

* ÐÐµÐ»ÑŒÐ·Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ `WHERE`.
* ÐžÑ‡ÐµÐ½ÑŒ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ â€” Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÑ‚ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð±ÐµÐ· Ñ‡Ñ‚ÐµÐ½Ð¸Ñ ÑÑ‚Ñ€Ð¾Ðº.
* Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ ÑÑ‡Ñ‘Ñ‚Ñ‡Ð¸Ðº `SERIAL` (ÐµÑÐ»Ð¸ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ `RESTART IDENTITY OFF`).

---

## âš ï¸ Ð’Ð»Ð¸ÑÐ½Ð¸Ðµ Ð½Ð° `SERIAL` / `IDENTITY`

```sql
TRUNCATE TABLE sales RESTART IDENTITY;
-- ID ÑÐ½Ð¾Ð²Ð° Ð½Ð°Ñ‡Ð½ÐµÑ‚ÑÑ Ñ 1
```

```sql
TRUNCATE TABLE sales CONTINUE IDENTITY;
-- ID Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
```

---

## âœ… ÐšÐ¾Ð³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ:

| Ð¡Ð¸Ñ‚ÑƒÐ°Ñ†Ð¸Ñ                        | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹                    |
| ------------------------------- | ---------------------------- |
| Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ñ‡Ð½Ð¾               | `DELETE`                     |
| ÐÑƒÐ¶Ð½Ð¾ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹          | `DELETE`                     |
| ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ **Ð²ÑÑŽ** Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ | `TRUNCATE`                   |
| ÐžÑÐ²Ð¾Ð±Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¼ÐµÑÑ‚Ð¾, ÑÐ±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ ID   | `TRUNCATE`                   |
| Ð•ÑÑ‚ÑŒ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ ÐºÐ»ÑŽÑ‡Ð¸ â€” Ð¾ÑÑ‚Ð¾Ñ€Ð¾Ð¶Ð½Ð¾! | Ð›ÑƒÑ‡ÑˆÐµ `DELETE` Ð¸Ð»Ð¸ `CASCADE` |

---

Ð¥Ð¾Ñ‡ÐµÑˆÑŒ Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð³Ð´Ðµ `TRUNCATE` Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¸Ð·-Ð·Ð° Ð²Ð½ÐµÑˆÐ½ÐµÐ³Ð¾ ÐºÐ»ÑŽÑ‡Ð° (`FOREIGN KEY`)?





Ð’ PostgreSQL Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ **Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð°Ð½Ð½Ñ‹Ñ…** Ñ‡ÐµÑ€ÐµÐ· Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ (constraints), Ñ‚Ð°ÐºÐ¸Ðµ ÐºÐ°Ðº:

1. **Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ ÐºÐ»ÑŽÑ‡Ð¸ (`FOREIGN KEY`)**
2. **Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ (`DEFAULT`)**
3. **Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ (`UNIQUE`)**

Ð’Ð¾Ñ‚ ÐºÐ°Ðº Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ ÑÑ‚Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ â€” Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð¸ **Ð½Ð° ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ**.

---

## ðŸ“Œ 1. **Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ ÐºÐ»ÑŽÑ‡ (`FOREIGN KEY`)**

ÐžÐ±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ ÑÑÑ‹Ð»Ð¾Ñ‡Ð½ÑƒÑŽ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ: Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð¾ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ.

### ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    customer_id INT REFERENCES customers(id)
);
```

Ð˜Ð»Ð¸ ÑÐ²Ð½Ð¾:

```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    customer_id INT,
    FOREIGN KEY (customer_id) REFERENCES customers(id)
);
```

### Ðš ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ:

```sql
ALTER TABLE orders
ADD CONSTRAINT fk_customer
FOREIGN KEY (customer_id) REFERENCES customers(id);
```

---

## ðŸ“Œ 2. **Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ (`DEFAULT`)**

ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€Ð¸ÑÐ²Ð°Ð¸Ð²Ð°ÐµÑ‚ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ, ÐµÑÐ»Ð¸ Ð¾Ð½Ð¾ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¾ Ð¿Ñ€Ð¸ Ð²ÑÑ‚Ð°Ð²ÐºÐµ.

### ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    price NUMERIC DEFAULT 0.0,
    created_at TIMESTAMP DEFAULT now()
);
```

### Ðš ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ:

```sql
ALTER TABLE products
ALTER COLUMN price SET DEFAULT 0.0;
```

Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ `DEFAULT`:

```sql
ALTER TABLE products
ALTER COLUMN price DROP DEFAULT;
```

---

## ðŸ“Œ 3. **Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ (`UNIQUE`)**

Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð² ÐºÐ¾Ð»Ð¾Ð½ÐºÐµ (Ð¸Ð»Ð¸ Ð½Ð°Ð±Ð¾Ñ€Ðµ ÐºÐ¾Ð»Ð¾Ð½Ð¾Ðº) ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹.

### ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email TEXT UNIQUE
);
```

Ð˜Ð»Ð¸ Ñ ÑÐ²Ð½Ñ‹Ð¼ Ð¸Ð¼ÐµÐ½ÐµÐ¼:

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email TEXT,
    CONSTRAINT unique_email UNIQUE (email)
);
```

### Ðš ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ:

```sql
ALTER TABLE users
ADD CONSTRAINT unique_email UNIQUE (email);
```

---

## ðŸ” ÐšÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ

ÐœÐ¾Ð¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ `UNIQUE` Ð½Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð»Ð¾Ð½Ð¾Ðº:

```sql
ALTER TABLE orders
ADD CONSTRAINT unique_order_combo UNIQUE (customer_id, product_id);
```

---

## ðŸ’¡ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ (CHECK)

Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:

```sql
ALTER TABLE products
ADD CONSTRAINT check_price_positive CHECK (price > 0);
```

---